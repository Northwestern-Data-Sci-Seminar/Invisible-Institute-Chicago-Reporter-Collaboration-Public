# Checkpoint 3: Interactive Visualization and Data Exploration

## Important Info

For this checkpoint, we needed to perform topic modeling in order to generate a set of new categories with which we can recategorize the existing set of complaints based on their summary text. To this end, we put together code for performing Latent Dirichlet Analysis (LDA) to produce a set of topics based on the summary text of the complaints. Full instructions for how to run the LDA to generate the topics is included in the `findings.pdf` for this checkpoint. Note that LDA is a nondeterministic process and the same set of topics are not guaranteed to be created during successive runs. The visualizations that follow illustrate the relationships that exist between the preexisting complaint categories and the topics generated by the LDA models.

## Interactive Visualizations

Each of the visualizations was produced on https://observablehq.com/ using D3.js. To view the visualizations for each question, simply navigate to the link provided in the following sections.

### Visualization 1: Sankey diagram to visualize how uncategorized or miscategorized complaints are recategorized by our LDA topic modeling

*Note: This question was originally "Chord dependency diagram to visualize how uncategorized or miscategorized complaints are re-categorized by our topic modeling" in our project proposal, but was changed due to the one-directional nature of our preexisting category to topic relationships.*

To view interactive visualization 1, go here: https://observablehq.com/@servantez/checkpoint-3-interactive-visualization-and-data-explorat/3

**NOTE: the underlying data for visualization 1 ended up being much simpler than expected so we added an additional visualization**

![visualization 1](https://github.com/Northwestern-Data-Sci-Seminar/Invisible-Institute-Chicago-Reporter-Collaboration-Public/blob/enchanted-badgers/The%20Enchanted%20Badgers/checkpoint-3/screenshots/viz_1.png)

### Visualization 2: Filtered Sankey diagram to visualize how 10 different LDA topic models classified preexisting complaint categories into topics

To view interactive visualization 2, go here: https://observablehq.com/@servantez/checkpoint-3-interactive-visualization-and-data-explorat/2

![visualization 2](https://github.com/Northwestern-Data-Sci-Seminar/Invisible-Institute-Chicago-Reporter-Collaboration-Public/blob/enchanted-badgers/The%20Enchanted%20Badgers/checkpoint-3/screenshots/viz_2.png)

### Visualization 3: Hierarchical Bar Chart to visualize how preexisting complaint categories are classified by our LDA topic modeling

To view interactive visualization 3, go here: https://observablehq.com/@servantez/checkpoint-3-interactive-visualization-and-data-explorat

![visualization 3](https://github.com/Northwestern-Data-Sci-Seminar/Invisible-Institute-Chicago-Reporter-Collaboration-Public/blob/enchanted-badgers/The%20Enchanted%20Badgers/checkpoint-3/screenshots/viz_3.png)

### Instructions to Reproduce LDA Topic Models
All LDA topic models have already been generated, but this sections contains directions on how to reproduce, if you would like to do so. Note that LDA is a nondeterministic process and the same set of topics are not guaranteed to be created during successive runs.

1. Run “pip install -r requirements_lda.txt”
2. Run “python -m spacy download en_core_web_lg”
3. Run “python lda.py”. This file preprocesses the narrative summaries and feeds it into Scikit-Learn’s LDA. We train 10 different LDA models, each with 20 topics described by 12 words each. 
  1. This choice was driven by qualitative analysis. We opted for 20 topics because we wanted roughly as many categories as for the original complaints. The 12 words per topic was largely subjective - we decided on it because we found the different topics were more explainable with that number of words, in addition to not having single words show up repeatedly over many topics - a word helping define a few topics is good, but if it defines many topics it becomes meaningless.
  2. “lda.py” outputs a new directory “lda_models_and_test_files” which contains the models and the words that define the topics for each model
4. Run “python lda_topic_freq_and_summaries.py”
  1. This outputs a new directory “lda_topic_csv_files” with accompanying csv files used for the interactive visualizations
5. Run “python csv_script.py”
  1. This inserts “aggregation.csv” into the “lda_topic_csv_files” directory, which is the final file needed for the interactive visualizations
